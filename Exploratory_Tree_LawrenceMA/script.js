d3.csv("cities.csv",t=>({...t,eu:"true"===t.eu,population:+t.population,x:+t.x,y:+t.y})).then(t=>{t=t.filter(t=>t.eu);console.log("cities",t);const e=d3.select(".population-plot").append("svg").attr("width",700).attr("height",550);e.selectAll("circle").data(t).enter().append("circle").attr("fill","#2196f3").attr("r",t=>t.population<1e6?4:8).attr("cx",t=>t.x).attr("cy",t=>t.y),e.selectAll("text").data(t).enter().filter(t=>1e6<t.population).append("text").attr("class","data-label").text(t=>t.city).attr("x",t=>t.x).attr("y",t=>t.y).attr("text-anchor","middle").attr("dy",-12),d3.select(".city-count").text("Number of Cities: "+t.length)}),d3.csv("buildings.csv",d3.autoType).then(t=>{console.log("buildings",t),t.sort((t,e)=>e.height_px-t.height_px);const e=d3.select(".heightchart").append("svg").attr("width",500).attr("height",500);e.selectAll("rect").data(t).enter().append("rect").attr("class","bar").attr("fill","#ff9800").attr("x",180).attr("y",(t,e)=>35*e).attr("height",30).attr("width",t=>t.height_px).on("click",(t,e)=>{console.log("clicked",e),d3.select(".image").attr("src","https://cdn.glitch.com/a9660dae-4e11-4fbe-a37b-62b5ae9c3232%2F"+e.image),d3.select(".height").text(e.height_ft),d3.select(".city").text(e.city),d3.select(".city").text(e.city),d3.select(".floor").text(e.floors),d3.select(".completed").text(e.completed)}),e.selectAll(".category-label").data(t).enter().append("text").attr("class","category-label").attr("x",0).attr("y",(t,e)=>35*e).attr("alignment-baseline","hanging").attr("text-anchor","start").attr("font-size",11).attr("dy",10).text(t=>t.building),e.selectAll(".value-label").data(t).enter().append("text").attr("class","value-label").attr("x",t=>180+t.height_px).attr("y",(t,e)=>35*e).attr("alignment-baseline","hanging").attr("text-anchor","end").attr("font-size",11).attr("dy",10).attr("dx",-10).attr("fill","white").text(t=>t.height_ft+" ft")});